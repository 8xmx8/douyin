import{E as w,x as c,m as k,al as F,aC as g,aD as M,aE as N,H as _,O as r,ah as d,J as x,T as b,ai as z,M as u,L as B,K as v,W as C,P as T,V as A,aF as H,aG as R,aH as U,aI as j,av as G}from"./index-483b83c5.js";/* empty css                   */const J={class:"main"},K=["onClick"],O={style:{width:"70%"}},P={style:{"font-size":"18px"}},W={class:"message"},q={class:"chat"},Q=w({__name:"index",setup(X){const I=c(-1),E=c([]),p=c([]),l=c(""),y=c();let f;const m=k("userInfo"),V=k("loginDialog");let h=0;function D(e,n){y.value=e,I.value=n,g.user.MessageChat(e.id).then(t=>{var o;t.status_code==0&&(p.value=t.message_list,t.message_list.length>0&&(h=(o=t.message_list[t.message_list.length-1])==null?void 0:o.create_time),clearInterval(f),f=setInterval(()=>{g.user.MessageChat(e.id,h).then(a=>{a.status_code==0&&(a.message_list.length>0&&(h=a.message_list[a.message_list.length-1].create_time),p.value.push(...a.message_list))})},1e3))})}function L(){var e;g.user.MessageAction((e=y.value)==null?void 0:e.id,l.value).then(n=>{n.status_code==0&&(l.value="",M.success("发送成功"))})}return F(()=>{m!=null&&m.value?g.user.RelationFriendList().then(e=>{e.status_code==0&&(E.value=e.user_list)}):(M.error("请先登录"),V&&(V.value=!0))}),N(()=>{clearInterval(f)}),(e,n)=>{const t=H,o=R,a=U,S=j;return _(),r("div",J,[d(o,{class:"friend"},{default:x(()=>[(_(!0),r(b,null,z(u(E),(s,i)=>(_(),r("div",{class:B(["item",{click:u(I)==i}]),onClick:()=>{D(s,i)}},[d(t,{src:s.avatar,size:32},null,8,["src"]),v("div",O,[v("div",P,C(s.name),1),v("div",W,C(s.message),1)])],10,K))),256))]),_:1}),v("div",q,[d(o,{class:"message"},{default:x(()=>[(_(!0),r(b,null,z(u(p),s=>{var i;return _(),r("div",{class:B(["const",s.from_user_id==((i=u(m))==null?void 0:i.id)?"right":"left"])},C(s.content),3)}),256))]),_:1}),d(a,{modelValue:u(l),"onUpdate:modelValue":n[0]||(n[0]=s=>T(l)?l.value=s:null),type:"textarea",placeholder:"我来讲两句.",maxlength:100,resize:"none"},null,8,["modelValue"]),d(S,{type:"success",plain:"",class:"send",onClick:L},{default:x(()=>[A(" Send ")]),_:1})])])}}});const $=G(Q,[["__scopeId","data-v-d534a8ed"]]);export{$ as default};
